# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨­è¨ˆä»•æ§˜æ›¸
**ãƒˆã‚­ãƒ¯ã‚·ãƒ†ã‚£è¨“ç·´æ‰€ - åˆä»£ãƒã‚±ãƒ¢ãƒ³ãƒªã‚¹ãƒšã‚¯ãƒˆ UI**

---

## 1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ¦‚è¦

### 1.1 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **Framework**: Next.js 14 (App Router)
- **UI Library**: shadcn/ui + ã‚«ã‚¹ã‚¿ãƒ ãƒ¬ãƒˆãƒ­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **Styling**: Tailwind CSS + CSS Modules (ãƒ‰ãƒƒãƒˆçµµå¯¾å¿œ)
- **State Management**: Zustand + React Query
- **Animation**: Framer Motion + CSS Animations
- **Icons**: Pixel Art Icons + Lucide Icons
- **Real-time**: Supabase Realtime + Server-Sent Events
- **Image Processing**: Next.js Image + Sharp

### 1.2 ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ†ãƒ¼ãƒï¼šåˆä»£ãƒã‚±ãƒ¢ãƒ³ãƒªã‚¹ãƒšã‚¯ãƒˆ

#### ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆï¼ˆGame Boyé¢¨ï¼‰
```css
:root {
  /* Game Boy Original (4è‰²) */
  --gb-dark-green: #0F380F;
  --gb-mid-green: #306230;
  --gb-light-green: #8BAC0F;
  --gb-lightest-green: #9BBD0F;
  
  /* Game Boy Color (æ‹¡å¼µãƒ‘ãƒ¬ãƒƒãƒˆ) */
  --gbc-red: #C84448;
  --gbc-blue: #4488CC;
  --gbc-yellow: #F4D444;
  --gbc-orange: #F4A444;
  
  /* UIæ‹¡å¼µè‰² */
  --retro-text: #0F380F;
  --retro-bg: #9BBD0F;
  --retro-border: #306230;
  --retro-accent: #C84448;
  
  /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
  --pixel-animation-speed: 0.5s;
  --text-scroll-speed: 2s;
}
```

#### ãƒ•ã‚©ãƒ³ãƒˆè¨­å®š
```css
/* ãƒ¬ãƒˆãƒ­ãƒ•ã‚©ãƒ³ãƒˆ */
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

.font-pixel {
  font-family: 'Press Start 2P', monospace;
  font-size: 8px;
  line-height: 1.4;
  letter-spacing: 0.05em;
}

.font-pixel-large {
  font-family: 'Press Start 2P', monospace;
  font-size: 12px;
  line-height: 1.2;
}
```

---

## 2. ãƒšãƒ¼ã‚¸æ§‹æˆãƒ»ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### 2.1 App Routeræ§‹æˆ
```
app/
â”œâ”€â”€ layout.tsx              # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆãƒ¬ãƒˆãƒ­UIå…±é€šè¦ç´ ï¼‰
â”œâ”€â”€ page.tsx               # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆã‚¹ã‚¯ãƒ¼ãƒ«æ¦‚è¦ï¼‰
â”œâ”€â”€ globals.css            # ãƒ¬ãƒˆãƒ­ã‚¹ã‚¿ã‚¤ãƒ«å®šç¾©
â”œâ”€â”€ components/            # å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ (dashboard)/           # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚°ãƒ«ãƒ¼ãƒ—
â”‚   â”œâ”€â”€ layout.tsx         # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”œâ”€â”€ trainers/          # ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ page.tsx       # ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼ä¸€è¦§
â”‚   â”‚   â”œâ”€â”€ [id]/          # å€‹åˆ¥ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx   # ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼è©³ç´°
â”‚   â”‚   â”‚   â””â”€â”€ edit/      # ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼ç·¨é›†
â”‚   â”‚   â””â”€â”€ hire/          # æ–°è¦é›‡ç”¨
â”‚   â”œâ”€â”€ expeditions/       # æ´¾é£ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ page.tsx       # æ´¾é£ä¸€è¦§ãƒ»ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ [id]/          # å€‹åˆ¥æ´¾é£è©³ç´°
â”‚   â”‚   â”œâ”€â”€ locations/     # æ´¾é£å…ˆä¸€è¦§
â”‚   â”‚   â””â”€â”€ active/        # é€²è¡Œä¸­æ´¾é£
â”‚   â”œâ”€â”€ pokemon/           # ãƒã‚±ãƒ¢ãƒ³ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ page.tsx       # ãƒã‚±ãƒ¢ãƒ³ä¸€è¦§
â”‚   â”‚   â”œâ”€â”€ [id]/          # å€‹åˆ¥ãƒã‚±ãƒ¢ãƒ³
â”‚   â”‚   â”œâ”€â”€ dex/           # å›³é‘‘
â”‚   â”‚   â””â”€â”€ party/         # ãƒ‘ãƒ¼ãƒ†ã‚£ç·¨æˆ
â”‚   â”œâ”€â”€ facilities/        # æ–½è¨­ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ page.tsx       # æ–½è¨­ä¸€è¦§
â”‚   â”‚   â”œâ”€â”€ [id]/          # å€‹åˆ¥æ–½è¨­
â”‚   â”‚   â””â”€â”€ upgrade/       # ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ economy/           # çµŒæ¸ˆç®¡ç†
â”‚   â”‚   â”œâ”€â”€ page.tsx       # åæ”¯ã‚µãƒãƒªãƒ¼
â”‚   â”‚   â”œâ”€â”€ transactions/  # å–å¼•å±¥æ­´
â”‚   â”‚   â””â”€â”€ reports/       # ãƒ¬ãƒãƒ¼ãƒˆ
â”‚   â””â”€â”€ events/            # ã‚¤ãƒ™ãƒ³ãƒˆãƒ»å¤§ä¼š
â”œâ”€â”€ interventions/         # ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä»‹å…¥ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰
â”œâ”€â”€ settings/              # è¨­å®š
â””â”€â”€ loading.tsx            # ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ï¼ˆãƒ‰ãƒƒãƒˆçµµã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
```

### 2.2 ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨­è¨ˆ

#### ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆåˆä»£ãƒã‚±ãƒ¢ãƒ³é¢¨ï¼‰
```typescript
// app/layout.tsx
interface RootLayoutProps {
  children: React.ReactNode;
}

export default function RootLayout({ children }: RootLayoutProps) {
  return (
    <html lang="ja">
      <body className="font-pixel bg-retro-bg text-retro-text">
        <RetroGameBoy>
          <Header />
          <NavigationMenu />
          <main className="pixel-container">
            {children}
          </main>
          <Footer />
          <InterventionManager />
          <NotificationSystem />
        </RetroGameBoy>
      </body>
    </html>
  );
}
```

#### Game Boyé¢¨UIã‚³ãƒ³ãƒ†ãƒŠ
```tsx
// components/layout/RetroGameBoy.tsx
interface RetroGameBoyProps {
  children: React.ReactNode;
}

export const RetroGameBoy: React.FC<RetroGameBoyProps> = ({ children }) => {
  return (
    <div className="gameboy-container">
      {/* Game Boyå¤–è£… */}
      <div className="gameboy-shell">
        {/* ã‚¹ã‚¯ãƒªãƒ¼ãƒ³éƒ¨åˆ† */}
        <div className="gameboy-screen">
          <div className="pixel-grid">
            {children}
          </div>
        </div>
        
        {/* ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒƒãƒ‰ï¼ˆè£…é£¾ï¼‰ */}
        <div className="gameboy-controls">
          <div className="d-pad"></div>
          <div className="action-buttons">
            <button className="btn-a">A</button>
            <button className="btn-b">B</button>
          </div>
        </div>
      </div>
    </div>
  );
};
```

---

## 3. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ

### 3.1 ãƒ¬ãƒˆãƒ­UIåŸºæœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### PixelButtonï¼ˆãƒ‰ãƒƒãƒˆçµµé¢¨ãƒœã‚¿ãƒ³ï¼‰
```tsx
// components/ui/PixelButton.tsx
interface PixelButtonProps {
  variant: 'primary' | 'secondary' | 'danger' | 'success';
  size: 'sm' | 'md' | 'lg';
  children: React.ReactNode;
  onClick?: () => void;
  disabled?: boolean;
  loading?: boolean;
}

export const PixelButton: React.FC<PixelButtonProps> = ({
  variant,
  size,
  children,
  onClick,
  disabled,
  loading
}) => {
  return (
    <button
      className={`
        pixel-button
        pixel-button--${variant}
        pixel-button--${size}
        ${disabled ? 'pixel-button--disabled' : ''}
        ${loading ? 'pixel-button--loading' : ''}
      `}
      onClick={onClick}
      disabled={disabled}
    >
      {loading && <PixelSpinner />}
      <span className="pixel-button__text">{children}</span>
    </button>
  );
};

/* CSS */
.pixel-button {
  @apply font-pixel border-2 border-retro-border bg-retro-bg;
  image-rendering: pixelated;
  transition: all 0.1s ease-in-out;
  
  /* ãƒ‰ãƒƒãƒˆçµµé¢¨ã®3DåŠ¹æœ */
  box-shadow: 
    2px 2px 0px var(--retro-border),
    4px 4px 0px rgba(15, 56, 15, 0.3);
}

.pixel-button:hover {
  transform: translate(-1px, -1px);
  box-shadow: 
    3px 3px 0px var(--retro-border),
    5px 5px 0px rgba(15, 56, 15, 0.3);
}

.pixel-button:active {
  transform: translate(1px, 1px);
  box-shadow: 
    1px 1px 0px var(--retro-border),
    2px 2px 0px rgba(15, 56, 15, 0.3);
}
```

#### PixelDialogï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ï¼‰
```tsx
// components/ui/PixelDialog.tsx
interface PixelDialogProps {
  open: boolean;
  onClose: () => void;
  title?: string;
  children: React.ReactNode;
  showCloseButton?: boolean;
}

export const PixelDialog: React.FC<PixelDialogProps> = ({
  open,
  onClose,
  title,
  children,
  showCloseButton = true
}) => {
  if (!open) return null;

  return (
    <div className="pixel-dialog-overlay">
      <div className="pixel-dialog">
        {/* åˆä»£ãƒã‚±ãƒ¢ãƒ³é¢¨ã®ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ */}
        {title && (
          <div className="pixel-dialog-header">
            <h3 className="font-pixel-large">{title}</h3>
            {showCloseButton && (
              <button className="pixel-close-btn" onClick={onClose}>
                Ã—
              </button>
            )}
          </div>
        )}
        
        {/* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ */}
        <div className="pixel-dialog-content">
          {children}
        </div>
      </div>
    </div>
  );
};

/* CSS */
.pixel-dialog {
  @apply bg-retro-bg border-4 border-retro-border;
  max-width: 400px;
  min-height: 200px;
  image-rendering: pixelated;
  
  /* åˆä»£ãƒã‚±ãƒ¢ãƒ³ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹é¢¨ */
  border-image: 
    url('/images/ui/dialog-border.png') 8 repeat;
}
```

#### PixelProgressBar
```tsx
// components/ui/PixelProgressBar.tsx
interface PixelProgressBarProps {
  value: number; // 0-100
  max?: number;
  color: 'hp' | 'exp' | 'progress' | 'danger';
  showLabel?: boolean;
  animated?: boolean;
}

export const PixelProgressBar: React.FC<PixelProgressBarProps> = ({
  value,
  max = 100,
  color,
  showLabel,
  animated
}) => {
  const percentage = Math.min((value / max) * 100, 100);
  
  return (
    <div className="pixel-progress-container">
      {showLabel && (
        <div className="pixel-progress-label font-pixel">
          {value}/{max}
        </div>
      )}
      
      <div className="pixel-progress-bar">
        <div 
          className={`
            pixel-progress-fill 
            pixel-progress-fill--${color}
            ${animated ? 'pixel-progress-fill--animated' : ''}
          `}
          style={{ width: `${percentage}%` }}
        />
      </div>
    </div>
  );
};

/* CSS - ãƒã‚±ãƒ¢ãƒ³ã®HPãƒãƒ¼é¢¨ */
.pixel-progress-bar {
  @apply h-2 bg-gray-300 border border-retro-border;
  image-rendering: pixelated;
}

.pixel-progress-fill--hp {
  background: linear-gradient(90deg, #44CC44 0%, #88FF88 100%);
}

.pixel-progress-fill--exp {
  background: linear-gradient(90deg, #4488CC 0%, #88CCFF 100%);
}

.pixel-progress-fill--animated {
  animation: pixelGlow 1s ease-in-out infinite alternate;
}

@keyframes pixelGlow {
  from { filter: brightness(1); }
  to { filter: brightness(1.2); }
}
```

### 3.2 ã‚²ãƒ¼ãƒ å›ºæœ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### PokemonSpriteï¼ˆãƒã‚±ãƒ¢ãƒ³ãƒ‰ãƒƒãƒˆçµµè¡¨ç¤ºï¼‰
```tsx
// components/pokemon/PokemonSprite.tsx
interface PokemonSpriteProps {
  speciesId: number;
  variant: 'front' | 'back' | 'icon' | 'retro';
  size: 'xs' | 'sm' | 'md' | 'lg' | 'xl';
  animated?: boolean;
  shiny?: boolean;
  onClick?: () => void;
}

export const PokemonSprite: React.FC<PokemonSpriteProps> = ({
  speciesId,
  variant,
  size,
  animated,
  shiny,
  onClick
}) => {
  const { data: spriteData, isLoading } = usePokemonSprite(speciesId, variant);
  
  return (
    <div 
      className={`
        pokemon-sprite 
        pokemon-sprite--${size}
        ${animated ? 'pokemon-sprite--animated' : ''}
        ${shiny ? 'pokemon-sprite--shiny' : ''}
        ${onClick ? 'pokemon-sprite--clickable' : ''}
      `}
      onClick={onClick}
    >
      {isLoading ? (
        <PixelSpinner />
      ) : (
        <Image
          src={spriteData?.url || '/images/pokemon/unknown.png'}
          alt={spriteData?.name || 'Unknown Pokemon'}
          width={spriteData?.width || 64}
          height={spriteData?.height || 64}
          style={{ imageRendering: 'pixelated' }}
        />
      )}
      
      {animated && <PixelAnimationEffect />}
      {shiny && <ShinySparkleEffect />}
    </div>
  );
};

/* CSS */
.pokemon-sprite {
  @apply inline-block relative;
  image-rendering: pixelated;
  image-rendering: -moz-crisp-edges;
  image-rendering: crisp-edges;
}

.pokemon-sprite--animated {
  animation: pokemonBounce 2s ease-in-out infinite;
}

@keyframes pokemonBounce {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-4px); }
}

.pokemon-sprite--shiny::after {
  content: 'âœ¨';
  position: absolute;
  top: -4px;
  right: -4px;
  font-size: 12px;
  animation: sparkle 1s ease-in-out infinite;
}
```

#### TrainerCardï¼ˆãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼ã‚«ãƒ¼ãƒ‰ï¼‰
```tsx
// components/trainers/TrainerCard.tsx
interface TrainerCardProps {
  trainer: TrainerSummary;
  onClick?: () => void;
  showStatus?: boolean;
  showParty?: boolean;
}

export const TrainerCard: React.FC<TrainerCardProps> = ({
  trainer,
  onClick,
  showStatus,
  showParty
}) => {
  return (
    <div 
      className={`
        trainer-card
        ${onClick ? 'trainer-card--clickable' : ''}
        ${trainer.status === 'on_expedition' ? 'trainer-card--busy' : ''}
      `}
      onClick={onClick}
    >
      {/* ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆ */}
      <div className="trainer-card__sprite">
        <Image
          src={trainer.spritePath}
          alt={trainer.name}
          width={48}
          height={48}
          style={{ imageRendering: 'pixelated' }}
        />
      </div>
      
      {/* ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼æƒ…å ± */}
      <div className="trainer-card__info">
        <h3 className="font-pixel">{trainer.name}</h3>
        <p className="font-pixel text-xs">
          {trainer.job.nameJa} Lv.{trainer.job.level}
        </p>
        
        {showStatus && (
          <StatusBadge status={trainer.status} />
        )}
        
        {showParty && (
          <div className="trainer-card__party">
            <span className="font-pixel text-xs">
              ãƒ‘ãƒ¼ãƒ†ã‚£: {trainer.party.pokemonCount}/6
            </span>
            <PixelProgressBar 
              value={trainer.party.pokemonCount} 
              max={6}
              color="progress"
            />
          </div>
        )}
      </div>
      
      {/* ãƒ¬ãƒ™ãƒ«çµŒé¨“å€¤ãƒãƒ¼ */}
      <div className="trainer-card__exp">
        <PixelProgressBar
          value={trainer.job.experience}
          max={trainer.job.nextLevelExp}
          color="exp"
          showLabel={false}
        />
      </div>
    </div>
  );
};

/* CSS */
.trainer-card {
  @apply bg-retro-bg border-2 border-retro-border p-4 rounded-none;
  image-rendering: pixelated;
  transition: all 0.2s ease;
}

.trainer-card--clickable:hover {
  @apply bg-retro-accent transform scale-105;
  cursor: pointer;
}

.trainer-card--busy {
  @apply opacity-75;
  filter: grayscale(30%);
}
```

---

## 4. çŠ¶æ…‹ç®¡ç†è¨­è¨ˆ

### 4.1 Zustand Storeæ§‹æˆ

#### ãƒ¦ãƒ¼ã‚¶ãƒ¼çŠ¶æ…‹ç®¡ç†
```typescript
// stores/useUserStore.ts
interface UserState {
  user: User | null;
  isAuthenticated: boolean;
  loading: boolean;
  
  // Actions
  login: (credentials: GuestLoginRequest) => Promise<void>;
  logout: () => void;
  updateProfile: (updates: Partial<User>) => Promise<void>;
  refreshUser: () => Promise<void>;
}

export const useUserStore = create<UserState>((set, get) => ({
  user: null,
  isAuthenticated: false,
  loading: false,
  
  login: async (credentials) => {
    set({ loading: true });
    try {
      const response = await authAPI.guestLogin(credentials);
      set({ 
        user: response.data.user, 
        isAuthenticated: true,
        loading: false 
      });
    } catch (error) {
      set({ loading: false });
      throw error;
    }
  },
  
  logout: () => {
    set({ user: null, isAuthenticated: false });
    // Clear localStorage, etc.
  },
  
  updateProfile: async (updates) => {
    const { user } = get();
    if (!user) return;
    
    const response = await userAPI.updateProfile(updates);
    set({ user: response.data });
  },
  
  refreshUser: async () => {
    const response = await userAPI.getProfile();
    set({ user: response.data });
  }
}));
```

#### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹ç®¡ç†
```typescript
// stores/useRealtimeStore.ts
interface RealtimeState {
  expeditions: ActiveExpedition[];
  interventions: InterventionEvent[];
  notifications: Notification[];
  connectionStatus: 'connected' | 'disconnected' | 'reconnecting';
  
  // Actions
  connect: () => void;
  disconnect: () => void;
  addIntervention: (intervention: InterventionEvent) => void;
  removeIntervention: (id: string) => void;
  markNotificationRead: (id: string) => void;
}

export const useRealtimeStore = create<RealtimeState>((set, get) => ({
  expeditions: [],
  interventions: [],
  notifications: [],
  connectionStatus: 'disconnected',
  
  connect: () => {
    const eventSource = new EventSource('/api/v1/realtime/events');
    
    eventSource.onopen = () => {
      set({ connectionStatus: 'connected' });
    };
    
    eventSource.addEventListener('intervention_required', (event) => {
      const intervention = JSON.parse(event.data);
      set(state => ({
        interventions: [...state.interventions, intervention]
      }));
    });
    
    eventSource.addEventListener('expedition_progress', (event) => {
      const expeditionUpdate = JSON.parse(event.data);
      set(state => ({
        expeditions: state.expeditions.map(exp => 
          exp.id === expeditionUpdate.id 
            ? { ...exp, ...expeditionUpdate } 
            : exp
        )
      }));
    });
  },
  
  addIntervention: (intervention) => {
    set(state => ({
      interventions: [...state.interventions, intervention]
    }));
  },
  
  removeIntervention: (id) => {
    set(state => ({
      interventions: state.interventions.filter(i => i.id !== id)
    }));
  }
}));
```

### 4.2 React Queryè¨­å®š

#### API ã‚¯ã‚¨ãƒªè¨­å®š
```typescript
// hooks/useTrainerQueries.ts
export const useTrainerList = (filters: TrainersListQuery = {}) => {
  return useQuery({
    queryKey: ['trainers', 'list', filters],
    queryFn: () => trainerAPI.getTrainerList(filters),
    staleTime: 5 * 60 * 1000, // 5åˆ†
    cacheTime: 10 * 60 * 1000, // 10åˆ†
  });
};

export const useTrainerDetail = (trainerId: string) => {
  return useQuery({
    queryKey: ['trainers', 'detail', trainerId],
    queryFn: () => trainerAPI.getTrainerDetail(trainerId),
    enabled: !!trainerId,
    staleTime: 2 * 60 * 1000, // 2åˆ†
  });
};

export const useUpdateTrainer = () => {
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: ({ id, updates }: { id: string; updates: UpdateTrainerRequest }) =>
      trainerAPI.updateTrainer(id, updates),
    onSuccess: (data, { id }) => {
      // ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°
      queryClient.setQueryData(['trainers', 'detail', id], data);
      queryClient.invalidateQueries(['trainers', 'list']);
    },
  });
};
```

---

## 5. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ»ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œ

### 5.1 ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³

#### ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆè¨­å®š
```css
/* tailwind.config.js */
module.exports = {
  theme: {
    screens: {
      'xs': '320px',    // ãƒ¢ãƒã‚¤ãƒ«ç¸¦
      'sm': '640px',    // ãƒ¢ãƒã‚¤ãƒ«æ¨ª
      'md': '768px',    // ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆç¸¦
      'lg': '1024px',   // ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆæ¨ª
      'xl': '1280px',   // ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—
      '2xl': '1536px',  // å¤§å‹ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—
    }
  }
}
```

#### ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ
```tsx
// components/layout/ResponsiveLayout.tsx
export const ResponsiveLayout: React.FC<{ children: React.ReactNode }> = ({ 
  children 
}) => {
  const [isMobile, setIsMobile] = useState(false);
  
  useEffect(() => {
    const checkMobile = () => {
      setIsMobile(window.innerWidth < 768);
    };
    
    checkMobile();
    window.addEventListener('resize', checkMobile);
    return () => window.removeEventListener('resize', checkMobile);
  }, []);
  
  return (
    <div className={`
      responsive-layout
      ${isMobile ? 'layout-mobile' : 'layout-desktop'}
    `}>
      {isMobile ? (
        <MobileGameBoyLayout>{children}</MobileGameBoyLayout>
      ) : (
        <DesktopGameBoyLayout>{children}</DesktopGameBoyLayout>
      )}
    </div>
  );
};
```

### 5.2 ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£

#### ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
```tsx
// hooks/useKeyboardNavigation.ts
export const useKeyboardNavigation = (items: any[], onSelect: (item: any) => void) => {
  const [selectedIndex, setSelectedIndex] = useState(0);
  
  useEffect(() => {
    const handleKeyDown = (event: KeyboardEvent) => {
      switch (event.key) {
        case 'ArrowUp':
          event.preventDefault();
          setSelectedIndex(prev => 
            prev > 0 ? prev - 1 : items.length - 1
          );
          break;
        case 'ArrowDown':
          event.preventDefault();
          setSelectedIndex(prev => 
            prev < items.length - 1 ? prev + 1 : 0
          );
          break;
        case 'Enter':
        case ' ':
          event.preventDefault();
          onSelect(items[selectedIndex]);
          break;
      }
    };
    
    window.addEventListener('keydown', handleKeyDown);
    return () => window.removeEventListener('keydown', handleKeyDown);
  }, [items, selectedIndex, onSelect]);
  
  return { selectedIndex, setSelectedIndex };
};
```

#### ARIAå¯¾å¿œ
```tsx
// components/ui/PixelMenu.tsx
interface PixelMenuProps {
  items: MenuItem[];
  onSelect: (item: MenuItem) => void;
  ariaLabel: string;
}

export const PixelMenu: React.FC<PixelMenuProps> = ({
  items,
  onSelect,
  ariaLabel
}) => {
  const { selectedIndex } = useKeyboardNavigation(items, onSelect);
  
  return (
    <nav 
      className="pixel-menu"
      role="menu"
      aria-label={ariaLabel}
    >
      {items.map((item, index) => (
        <button
          key={item.id}
          className={`
            pixel-menu-item
            ${index === selectedIndex ? 'pixel-menu-item--selected' : ''}
          `}
          role="menuitem"
          aria-selected={index === selectedIndex}
          onClick={() => onSelect(item)}
        >
          {item.icon && <span aria-hidden="true">{item.icon}</span>}
          <span>{item.label}</span>
        </button>
      ))}
    </nav>
  );
};
```

---

## 6. ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ

### 6.1 ãƒšãƒ¼ã‚¸é·ç§»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

#### ãƒ‰ãƒƒãƒˆçµµé¢¨ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³
```tsx
// components/animations/PixelTransition.tsx
export const PixelTransition: React.FC<{ children: React.ReactNode }> = ({ 
  children 
}) => {
  return (
    <motion.div
      initial={{ opacity: 0, scale: 0.8 }}
      animate={{ opacity: 1, scale: 1 }}
      exit={{ opacity: 0, scale: 1.2 }}
      transition={{
        type: "spring",
        damping: 25,
        stiffness: 500,
        duration: 0.3
      }}
    >
      {children}
    </motion.div>
  );
};

// ãƒšãƒ¼ã‚¸å˜ä½ã§ã®ä½¿ç”¨
export default function TrainersPage() {
  return (
    <PixelTransition>
      <div className="trainers-page">
        {/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
      </div>
    </PixelTransition>
  );
}
```

### 6.2 ã‚²ãƒ¼ãƒ å›ºæœ‰ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

#### ãƒã‚±ãƒ¢ãƒ³ç™»å ´ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
```tsx
// components/animations/PokemonAppearAnimation.tsx
interface PokemonAppearAnimationProps {
  pokemon: PokemonInstance;
  onComplete: () => void;
}

export const PokemonAppearAnimation: React.FC<PokemonAppearAnimationProps> = ({
  pokemon,
  onComplete
}) => {
  return (
    <motion.div
      className="pokemon-appear-animation"
      initial={{ x: -200, opacity: 0 }}
      animate={{ x: 0, opacity: 1 }}
      transition={{ duration: 0.8, ease: "easeOut" }}
      onAnimationComplete={onComplete}
    >
      <motion.div
        animate={{ y: [0, -10, 0] }}
        transition={{ 
          duration: 1.5, 
          repeat: Infinity,
          ease: "easeInOut"
        }}
      >
        <PokemonSprite 
          speciesId={pokemon.species.id}
          variant="front"
          size="lg"
          animated
        />
      </motion.div>
      
      {/* "é‡ç”Ÿã®â—‹â—‹ãŒé£›ã³å‡ºã—ã¦ããŸï¼"é¢¨ãƒ†ã‚­ã‚¹ãƒˆ */}
      <motion.div
        className="pokemon-appear-text"
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        transition={{ delay: 0.5 }}
      >
        <TypewriterText 
          text={`é‡ç”Ÿã®${pokemon.species.nameJa}ãŒç¾ã‚ŒãŸï¼`}
          speed={50}
        />
      </motion.div>
    </motion.div>
  );
};
```

#### ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
```tsx
// components/animations/LevelUpEffect.tsx
export const LevelUpEffect: React.FC<{
  visible: boolean;
  onComplete: () => void;
}> = ({ visible, onComplete }) => {
  if (!visible) return null;
  
  return (
    <motion.div
      className="level-up-effect"
      initial={{ scale: 0, opacity: 0 }}
      animate={{ scale: 1, opacity: 1 }}
      exit={{ scale: 1.5, opacity: 0 }}
      transition={{ duration: 0.6 }}
      onAnimationComplete={onComplete}
    >
      <motion.div
        className="level-up-flash"
        animate={{ opacity: [0, 1, 0, 1, 0] }}
        transition={{ duration: 0.8, times: [0, 0.2, 0.4, 0.6, 1] }}
      />
      
      <motion.h2
        className="font-pixel-large text-yellow-400"
        animate={{ y: [20, 0, -10, 0] }}
        transition={{ duration: 0.6 }}
      >
        LEVEL UP!
      </motion.h2>
    </motion.div>
  );
};
```

---

## 7. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### 7.1 ç”»åƒæœ€é©åŒ–

#### ãƒ‰ãƒƒãƒˆçµµã‚¢ã‚»ãƒƒãƒˆæœ€é©åŒ–
```typescript
// utils/imageOptimization.ts
export const optimizePokemonSprites = {
  // Next.js Imageè¨­å®š
  loader: ({ src, width, quality }: ImageLoaderProps) => {
    // ãƒ‰ãƒƒãƒˆçµµã¯æ‹¡å¤§æ™‚ã«ãƒ”ã‚¯ã‚»ãƒ«è£œé–“ã—ãªã„
    const params = new URLSearchParams({
      url: src,
      w: width.toString(),
      q: (quality || 75).toString(),
      auto: 'format',
      fit: 'max',
      // é‡è¦: ãƒ‰ãƒƒãƒˆçµµã®ãŸã‚pixelatedã‚’ç¶­æŒ
      interpolation: 'nearest-neighbor'
    });
    
    return `/api/v1/assets/optimize?${params.toString()}`;
  },
  
  // ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰æˆ¦ç•¥
  preloadCriticalSprites: async (pokemonIds: number[]) => {
    const preloadPromises = pokemonIds.map(id => {
      const link = document.createElement('link');
      link.rel = 'preload';
      link.as = 'image';
      link.href = `/api/v1/assets/pokemon/${id}?style=icon&format=webp`;
      document.head.appendChild(link);
    });
    
    await Promise.all(preloadPromises);
  }
};
```

### 7.2 ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æœ€é©åŒ–

#### ä»®æƒ³åŒ–ãƒªã‚¹ãƒˆï¼ˆå¤§é‡ãƒã‚±ãƒ¢ãƒ³è¡¨ç¤ºç”¨ï¼‰
```tsx
// components/pokemon/VirtualizedPokemonList.tsx
import { FixedSizeList as List } from 'react-window';

interface VirtualizedPokemonListProps {
  pokemon: PokemonInstance[];
  onSelect: (pokemon: PokemonInstance) => void;
}

export const VirtualizedPokemonList: React.FC<VirtualizedPokemonListProps> = ({
  pokemon,
  onSelect
}) => {
  const Row = useCallback(({ index, style }: ListChildComponentProps) => (
    <div style={style}>
      <PokemonCard 
        pokemon={pokemon[index]}
        onClick={() => onSelect(pokemon[index])}
      />
    </div>
  ), [pokemon, onSelect]);
  
  return (
    <List
      height={400}
      itemCount={pokemon.length}
      itemSize={80}
      className="pokemon-virtual-list"
    >
      {Row}
    </List>
  );
};
```

### 7.3 çŠ¶æ…‹æœ€é©åŒ–

#### ãƒ¡ãƒ¢åŒ–æˆ¦ç•¥
```typescript
// hooks/useOptimizedTrainer.ts
export const useOptimizedTrainer = (trainerId: string) => {
  // åŸºæœ¬ãƒ‡ãƒ¼ã‚¿
  const { data: trainer } = useTrainerDetail(trainerId);
  
  // é‡ã„è¨ˆç®—çµæœã‚’ãƒ¡ãƒ¢åŒ–
  const trainerStats = useMemo(() => {
    if (!trainer) return null;
    
    return {
      totalPokemonLevel: trainer.party.reduce((sum, p) => sum + p.level, 0),
      averageLevel: trainer.party.length > 0 
        ? trainer.party.reduce((sum, p) => sum + p.level, 0) / trainer.party.length 
        : 0,
      typeDistribution: calculateTypeDistribution(trainer.party),
      battlePower: calculateBattlePower(trainer.party, trainer.job)
    };
  }, [trainer]);
  
  // ãƒ‘ãƒ¼ãƒ†ã‚£å¤‰æ›´ã®æ¤œå‡º
  const partyHash = useMemo(() => 
    trainer?.party.map(p => `${p.id}-${p.level}`).join('|') || '',
    [trainer?.party]
  );
  
  return { trainer, trainerStats, partyHash };
};
```

---

## 8. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ãƒ»é€šçŸ¥

### 8.1 ä»‹å…¥ã‚·ã‚¹ãƒ†ãƒ UI

#### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä»‹å…¥ãƒ€ã‚¤ã‚¢ãƒ­ã‚°
```tsx
// components/interventions/InterventionDialog.tsx
interface InterventionDialogProps {
  intervention: InterventionEvent;
  onRespond: (choiceId: number) => void;
  onTimeout: () => void;
}

export const InterventionDialog: React.FC<InterventionDialogProps> = ({
  intervention,
  onRespond,
  onTimeout
}) => {
  const [timeRemaining, setTimeRemaining] = useState(intervention.timeRemaining);
  
  useEffect(() => {
    const timer = setInterval(() => {
      setTimeRemaining(prev => {
        if (prev <= 1) {
          onTimeout();
          return 0;
        }
        return prev - 1;
      });
    }, 1000);
    
    return () => clearInterval(timer);
  }, [onTimeout]);
  
  return (
    <PixelDialog open={true} title="ç·Šæ€¥äº‹æ…‹ç™ºç”Ÿï¼">
      <div className="intervention-dialog">
        {/* ã‚¿ã‚¤ãƒãƒ¼è¡¨ç¤º */}
        <div className="intervention-timer">
          <PixelProgressBar 
            value={timeRemaining}
            max={intervention.timeRemaining}
            color="danger"
            animated
          />
          <span className="font-pixel text-xs">
            æ®‹ã‚Šæ™‚é–“: {timeRemaining}ç§’
          </span>
        </div>
        
        {/* ã‚¤ãƒ™ãƒ³ãƒˆèª¬æ˜ */}
        <div className="intervention-description">
          <TypewriterText 
            text={intervention.eventData.description}
            speed={30}
          />
        </div>
        
        {/* é¸æŠè‚¢ */}
        <div className="intervention-choices">
          {intervention.choices.map((choice, index) => (
            <PixelButton
              key={choice.id}
              variant={
                choice.risk === 'high' ? 'danger' :
                choice.risk === 'medium' ? 'secondary' :
                'primary'
              }
              onClick={() => onRespond(choice.id)}
            >
              <div className="choice-content">
                <div className="choice-text">{choice.text}</div>
                <div className="choice-risk">
                  ãƒªã‚¹ã‚¯: {choice.risk === 'high' ? 'é«˜' : choice.risk === 'medium' ? 'ä¸­' : 'ä½'}
                </div>
              </div>
            </PixelButton>
          ))}
        </div>
      </div>
    </PixelDialog>
  );
};
```

### 8.2 é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ 

#### ãƒ‰ãƒƒãƒˆçµµé¢¨é€šçŸ¥
```tsx
// components/notifications/PixelNotification.tsx
interface PixelNotificationProps {
  notification: Notification;
  onDismiss: (id: string) => void;
}

export const PixelNotification: React.FC<PixelNotificationProps> = ({
  notification,
  onDismiss
}) => {
  return (
    <motion.div
      className={`pixel-notification pixel-notification--${notification.priority}`}
      initial={{ x: 300, opacity: 0 }}
      animate={{ x: 0, opacity: 1 }}
      exit={{ x: 300, opacity: 0 }}
      transition={{ type: "spring", damping: 25, stiffness: 500 }}
    >
      <div className="notification-icon">
        {getNotificationIcon(notification.type)}
      </div>
      
      <div className="notification-content">
        <h4 className="font-pixel">{notification.title}</h4>
        <p className="font-pixel text-xs">{notification.message}</p>
      </div>
      
      <button 
        className="notification-close"
        onClick={() => onDismiss(notification.id)}
        aria-label="é€šçŸ¥ã‚’é–‰ã˜ã‚‹"
      >
        Ã—
      </button>
    </motion.div>
  );
};

// é€šçŸ¥ç®¡ç†ã‚³ãƒ³ãƒ†ãƒŠ
export const NotificationContainer: React.FC = () => {
  const { notifications } = useRealtimeStore();
  
  return (
    <div className="notification-container">
      <AnimatePresence>
        {notifications.map(notification => (
          <PixelNotification 
            key={notification.id}
            notification={notification}
            onDismiss={useRealtimeStore.getState().markNotificationRead}
          />
        ))}
      </AnimatePresence>
    </div>
  );
};
```

---

## 9. ãƒ†ãƒ¼ãƒãƒ»ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### 9.1 ãƒ¬ãƒˆãƒ­ãƒ†ãƒ¼ãƒã‚·ã‚¹ãƒ†ãƒ 

#### ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ
```typescript
// contexts/ThemeContext.tsx
interface RetroTheme {
  name: string;
  colors: {
    primary: string;
    secondary: string;
    background: string;
    text: string;
    border: string;
    accent: string;
  };
  palette: 'gameboy' | 'gameboy_color' | 'custom';
}

const themes: Record<string, RetroTheme> = {
  gameboy_green: {
    name: 'ã‚²ãƒ¼ãƒ ãƒœãƒ¼ã‚¤ï¼ˆç·‘ï¼‰',
    colors: {
      primary: '#9BBD0F',
      secondary: '#8BAC0F',
      background: '#9BBD0F',
      text: '#0F380F',
      border: '#306230',
      accent: '#0F380F'
    },
    palette: 'gameboy'
  },
  gameboy_red: {
    name: 'ãƒã‚±ãƒƒãƒˆãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼èµ¤',
    colors: {
      primary: '#FF6B6B',
      secondary: '#FF5252',
      background: '#FFF3E0',
      text: '#2C1810',
      border: '#8D4E3C',
      accent: '#FF5722'
    },
    palette: 'gameboy_color'
  },
  gameboy_blue: {
    name: 'ãƒã‚±ãƒƒãƒˆãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼é’',
    colors: {
      primary: '#4FC3F7',
      secondary: '#29B6F6',
      background: '#E3F2FD',
      text: '#0D47A1',
      border: '#1976D2',
      accent: '#2196F3'
    },
    palette: 'gameboy_color'
  }
};

export const ThemeProvider: React.FC<{ children: React.ReactNode }> = ({ 
  children 
}) => {
  const [currentTheme, setCurrentTheme] = useState<string>('gameboy_green');
  
  useEffect(() => {
    const theme = themes[currentTheme];
    const root = document.documentElement;
    
    Object.entries(theme.colors).forEach(([key, value]) => {
      root.style.setProperty(`--retro-${key}`, value);
    });
  }, [currentTheme]);
  
  return (
    <ThemeContext.Provider value={{ currentTheme, setCurrentTheme, themes }}>
      {children}
    </ThemeContext.Provider>
  );
};
```

### 9.2 ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

#### è¨­å®šãƒ‘ãƒãƒ«
```tsx
// components/settings/RetroThemeSettings.tsx
export const RetroThemeSettings: React.FC = () => {
  const { currentTheme, setCurrentTheme, themes } = useTheme();
  
  return (
    <div className="theme-settings">
      <h3 className="font-pixel-large">ãƒ†ãƒ¼ãƒè¨­å®š</h3>
      
      <div className="theme-grid">
        {Object.entries(themes).map(([key, theme]) => (
          <div
            key={key}
            className={`
              theme-preview
              ${currentTheme === key ? 'theme-preview--selected' : ''}
            `}
            onClick={() => setCurrentTheme(key)}
          >
            <div 
              className="theme-preview__swatch"
              style={{ backgroundColor: theme.colors.primary }}
            />
            <span className="font-pixel text-xs">{theme.name}</span>
          </div>
        ))}
      </div>
      
      {/* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ */}
      <div className="theme-preview-demo">
        <PixelButton variant="primary">ã‚µãƒ³ãƒ—ãƒ«ãƒœã‚¿ãƒ³</PixelButton>
        <PixelProgressBar value={75} max={100} color="hp" />
        <div className="font-pixel">ã‚µãƒ³ãƒ—ãƒ«ãƒ†ã‚­ã‚¹ãƒˆ</div>
      </div>
    </div>
  );
};
```

---

## 10. ãƒ†ã‚¹ãƒˆãƒ»å“è³ªç®¡ç†

### 10.1 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ

#### ãƒ‰ãƒƒãƒˆçµµã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆ
```typescript
// __tests__/components/PokemonSprite.test.tsx
import { render, screen } from '@testing-library/react';
import { PokemonSprite } from '@/components/pokemon/PokemonSprite';

describe('PokemonSprite', () => {
  it('ãƒã‚±ãƒ¢ãƒ³ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹', () => {
    render(
      <PokemonSprite 
        speciesId={25} 
        variant="front" 
        size="md" 
      />
    );
    
    const sprite = screen.getByRole('img');
    expect(sprite).toHaveStyle({ imageRendering: 'pixelated' });
  });
  
  it('ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãã§è¡¨ç¤ºã•ã‚Œã‚‹', () => {
    render(
      <PokemonSprite 
        speciesId={25} 
        variant="front" 
        size="md" 
        animated 
      />
    );
    
    const container = screen.getByText('pokemon-sprite--animated');
    expect(container).toBeInTheDocument();
  });
});
```

### 10.2 ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ

#### ARIAãƒ»ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ
```typescript
// __tests__/accessibility/KeyboardNavigation.test.tsx
import { render, screen, fireEvent } from '@testing-library/react';
import { PixelMenu } from '@/components/ui/PixelMenu';

describe('Keyboard Navigation', () => {
  const mockItems = [
    { id: '1', label: 'ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼ç®¡ç†', icon: 'ğŸ‘¨â€ğŸ«' },
    { id: '2', label: 'ãƒã‚±ãƒ¢ãƒ³ç®¡ç†', icon: 'ğŸ¾' },
    { id: '3', label: 'æ´¾é£ç®¡ç†', icon: 'ğŸ—ºï¸' }
  ];
  
  it('çŸ¢å°ã‚­ãƒ¼ã§ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã§ãã‚‹', () => {
    const onSelect = jest.fn();
    render(
      <PixelMenu 
        items={mockItems} 
        onSelect={onSelect}
        ariaLabel="ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼"
      />
    );
    
    // ä¸‹çŸ¢å°ã§ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç§»å‹•
    fireEvent.keyDown(window, { key: 'ArrowDown' });
    expect(screen.getByText('ãƒã‚±ãƒ¢ãƒ³ç®¡ç†')).toHaveAttribute('aria-selected', 'true');
    
    // Enterã§é¸æŠ
    fireEvent.keyDown(window, { key: 'Enter' });
    expect(onSelect).toHaveBeenCalledWith(mockItems[1]);
  });
});
```